/*!
 * tetris 1.0.0
 * A Russian tile-matching puzzle video game
 * https://git.oschina.net/dewlyer/Tetris.git
 *
 * Copyright (c) 2017 dewlyer liluak@yeah.net
 *
 * Released under the MIT license
 */
 define(["jquery"],function(t){function i(t,i,o,s){this.x=0,this.y=0,this.game=t,this.symmetrical=o,this.blockType=s,this.blockVariation=null,this.blocksLen=i[0].length,this.orientations=i,this.orientation=0,this.init()}return i.prototype={init:function(){this.orientation=0,this.x=Math.floor(this.game._BLOCK_WIDTH/2)-1,this.y=-1},rotate:function(t){var i=(this.orientation+("left"===t?1:-1)+4)%4;this.game._checkCollisions(this.x,this.y,this.getBlocks(i))||(this.orientation=i,this.game._board.renderChanged=!0)},moveRight:function(){this.game._checkCollisions(this.x+1,this.y,this.getBlocks())||(this.x++,this.game._board.renderChanged=!0)},moveLeft:function(){this.game._checkCollisions(this.x-1,this.y,this.getBlocks())||(this.x--,this.game._board.renderChanged=!0)},drop:function(){this.game._checkCollisions(this.x,this.y+1,this.getBlocks())||(this.y++,this.game._board.dropCount=-1,this.game._board.animate(),this.game._board.renderChanged=!0)},getBlocks:function(t){return this.orientations[void 0!==t?t:this.orientation]},draw:function(t,i,o){for(var s=this.getBlocks(o),h=void 0===t?this.x:t,e=void 0===i?this.y:i,n=0,r=0;n<this.blocksLen;n+=2)this.game._board.drawBlock(h+s[n],e+s[n+1],this.blockType,this.blockVariation,r,this.orientation,!0),r++},getBounds:function(i){for(var o=t.isArray(i)?i:this.getBlocks(i),s=0,h=o.length,e=999,n=-999,r=999,a=-999;s<h;s+=2)o[s]<e&&(e=o[s]),o[s]>n&&(n=o[s]),o[s+1]<r&&(r=o[s+1]),o[s+1]>a&&(a=o[s+1]);return{left:e,right:n,top:r,bottom:a,width:n-e,height:a-r}}},i});