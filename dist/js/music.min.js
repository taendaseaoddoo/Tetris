/*!
 * tetris 1.0.0
 * A Russian tile-matching puzzle video game
 * https://git.oschina.net/dewlyer/Tetris.git
 *
 * Copyright (c) 2017 dewlyer liluak@yeah.net
 *
 * Released under the MIT license
 */
 define(["jquery"],function(i){function t(i){this.config=i,this.audioEl=null,this.audioObj=null,this.currentId=-1,this.holder="body",this.paths="",this.playList=null,this.isRandom=!1}return t.prototype={init:function(){this.holder=this.config.holder||this.holder,this.isRandom=this.config.random||this.isRandom,this.paths=this.config.paths||this.paths,this.initPlayList(this.config.playlist),this.initAudio()},initPlayList:function(i){var t=typeof i;"undefined"===t?console.error("music list error!"):(this.playList=[],this.currentId=0,"string"===t?this.playList.push(i):this.playList=i)},initAudio:function(){this.audioEl=i("<audio>"),this.audioEl.attr("id","gameBgm").addClass("bgm-holder"),this.audioObj=this.audioEl[0],this.audioEl.appendTo(this.holder).hide(),this.bindEvent()},bindEvent:function(){var i=this;i.audioEl.on("ended",function(){i.playNext()})},randomId:function(){var i=this.playList.length;this.currentId=Math.floor(Math.random()*i)},stop:function(){this.audioObj.paused||this.audioObj.pause()},play:function(){this.isRandom&&this.randomId(),this.stop(),this.audioObj.src=this.paths+this.playList[this.currentId],this.audioObj.play()},playNext:function(){if(this.isRandom)this.randomId();else{var i=this.playList.length-1;this.currentId=this.currentId>=i?0:this.currentId+1}this.play()}},t});